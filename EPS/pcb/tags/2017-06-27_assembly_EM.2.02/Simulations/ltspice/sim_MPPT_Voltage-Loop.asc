Version 4
SHEET 1 3288 1452
WIRE 1136 -256 720 -256
WIRE 1168 -256 1136 -256
WIRE 1200 -256 1168 -256
WIRE 1504 -256 1200 -256
WIRE 1728 -256 1664 -256
WIRE 1872 -256 1728 -256
WIRE 720 -240 720 -256
WIRE 1200 -240 1200 -256
WIRE 400 -224 288 -224
WIRE 448 -224 400 -224
WIRE 560 -208 544 -208
WIRE 1504 -208 1472 -208
WIRE 448 -192 416 -192
WIRE 416 -176 416 -192
WIRE 1200 -160 1200 -176
WIRE 1472 -160 1472 -208
WIRE 1728 -160 1728 -176
WIRE 2000 -128 1920 -128
WIRE 1136 -96 1136 -256
WIRE 1920 -64 1920 -80
WIRE 1920 -64 1872 -64
WIRE 1872 -48 1872 -64
WIRE 1600 16 1536 16
WIRE 1696 16 1680 16
WIRE 1712 16 1696 16
WIRE 2640 16 1792 16
WIRE 336 32 336 16
WIRE 640 48 640 32
WIRE 1696 80 1696 16
WIRE 1136 96 1136 -16
WIRE 880 192 832 192
WIRE 896 192 880 192
WIRE 992 192 896 192
WIRE 1136 192 1136 176
WIRE 1136 192 992 192
WIRE 880 208 880 192
WIRE 720 224 528 224
WIRE 784 224 784 208
WIRE 784 224 720 224
WIRE 832 224 832 192
WIRE 832 224 784 224
WIRE 2256 224 2208 224
WIRE 2464 224 2320 224
WIRE 288 240 288 -224
WIRE 384 240 288 240
WIRE 432 240 384 240
WIRE 384 256 384 240
WIRE 720 256 528 256
WIRE 784 256 720 256
WIRE 832 256 784 256
WIRE 784 272 784 256
WIRE 992 272 992 192
WIRE 1536 272 1536 16
WIRE 1536 272 992 272
WIRE 832 288 832 256
WIRE 880 288 832 288
WIRE 288 304 288 240
WIRE 1040 336 992 336
WIRE 1104 336 1040 336
WIRE 1248 336 1184 336
WIRE 1456 336 1408 336
WIRE 384 352 384 336
WIRE 2096 368 2080 368
WIRE 2208 368 2208 224
WIRE 2208 368 2176 368
WIRE 2240 368 2208 368
WIRE 1248 384 1232 384
WIRE 880 400 624 400
WIRE 992 400 992 336
WIRE 992 400 880 400
WIRE 2464 400 2464 224
WIRE 2464 400 2384 400
WIRE 2640 400 2640 16
WIRE 2640 400 2464 400
WIRE 288 416 288 368
WIRE 384 416 288 416
WIRE 624 416 624 400
WIRE 1232 416 1232 384
WIRE 384 432 384 416
WIRE 2240 432 1952 432
WIRE 880 480 880 400
WIRE 992 480 992 400
WIRE 2080 496 2080 368
WIRE 1696 512 1632 512
WIRE 1824 512 1760 512
WIRE 768 592 640 592
WIRE 880 592 880 560
WIRE 880 592 768 592
WIRE 880 624 880 592
WIRE 992 624 992 560
WIRE 1232 624 992 624
WIRE 1264 624 1232 624
WIRE 1376 624 1344 624
WIRE 1632 624 1632 512
WIRE 1632 624 1376 624
WIRE 1680 624 1632 624
WIRE 1824 624 1824 512
WIRE 1824 624 1760 624
WIRE 1904 624 1824 624
WIRE 1952 624 1952 432
WIRE 1952 624 1904 624
WIRE 640 704 640 592
WIRE 768 704 768 592
WIRE 880 720 880 688
WIRE 640 784 640 768
WIRE 1632 784 1632 624
WIRE 1664 784 1632 784
WIRE 880 816 880 784
WIRE 1824 816 1824 624
WIRE 1824 816 1808 816
WIRE 1392 848 1376 848
WIRE 1504 848 1472 848
WIRE 1584 848 1504 848
WIRE 1664 848 1584 848
WIRE 1584 896 1584 848
WIRE 880 912 880 880
WIRE 1376 912 1376 848
WIRE 1504 912 1504 848
WIRE 1504 992 1504 976
WIRE 1584 992 1584 976
WIRE 1584 992 1504 992
WIRE 880 1008 880 976
WIRE 1584 1008 1584 992
WIRE 880 1104 880 1072
WIRE 880 1184 880 1168
FLAG 400 -224 Vc
FLAG 1200 -160 0
FLAG 720 224 Vgma_i
FLAG 1168 -256 Vout
FLAG 784 352 0
FLAG 384 432 0
FLAG 784 128 0
FLAG 896 192 FB
FLAG 720 256 Vgma_ni
FLAG 768 784 0
FLAG 416 -176 0
FLAG 560 -208 Ivin
FLAG 1472 -160 0
FLAG 720 -160 0
FLAG 640 48 0
FLAG 336 32 0
FLAG 336 -48 Vin
FLAG 2272 480 0
FLAG 2320 480 0
FLAG 1744 896 0
FLAG 1696 896 0
FLAG 1456 336 Vin
FLAG 1232 416 0
FLAG 2512 -48 0
FLAG 2512 -128 Vbatmin
FLAG 1728 -160 Vbatmin
FLAG 1872 -48 Vbatmin
FLAG 2000 -48 Vbatmin
FLAG 1376 992 0
FLAG 2080 576 0
FLAG 880 1184 0
FLAG 1376 704 0
FLAG 2608 672 0
FLAG 2608 592 SUPP
FLAG 2272 320 SUPP
FLAG 1696 736 SUPP
FLAG 640 784 0
FLAG 1040 336 V3
FLAG 640 -48 Vin
FLAG 624 480 0
FLAG 1584 1088 0
FLAG 1232 624 A
FLAG 1904 624 B
FLAG 1696 160 0
SYMBOL bi 720 -160 R180
WINDOW 0 -71 52 Left 2
WINDOW 3 -337 116 Left 2
SYMATTR InstName B2
SYMATTR Value I=limit(0, ((n*V(Vin))/V(Vout))*V(Ivin), 2)
SYMBOL cap 1184 -240 R0
WINDOW 0 37 11 Left 2
WINDOW 3 37 61 Left 2
WINDOW 39 39 37 Left 2
SYMATTR InstName C1
SYMATTR Value 20µF
SYMATTR SpiceLine Rser=10m Lser=3n
SYMATTR SpiceLine2 IC=4.9
SYMBOL voltage 784 256 R0
WINDOW 0 37 58 Left 2
WINDOW 3 36 81 Left 2
WINDOW 123 36 109 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 1.215V
SYMBOL res 864 192 R0
WINDOW 3 35 69 Left 2
SYMATTR Value 14.6k
SYMATTR InstName R5
SYMBOL res 768 112 R0
WINDOW 0 36 36 Left 2
WINDOW 3 35 58 Left 2
SYMATTR InstName R6
SYMATTR Value 14.6k
SYMBOL res 1120 80 R0
WINDOW 3 36 67 Left 2
SYMATTR Value {Ra}
SYMATTR InstName R1
SYMBOL res 368 240 R0
SYMATTR InstName R8
SYMATTR Value {Rc}
SYMBOL cap 368 352 R0
SYMATTR InstName C2
SYMATTR Value {Cc}
SYMBOL cap 272 304 R0
SYMATTR InstName C3
SYMATTR Value {Cf}
SYMBOL res 1856 -272 R0
WINDOW 3 37 63 Left 2
SYMATTR Value 40R
SYMATTR InstName R4
SYMBOL sw 1872 -48 R180
WINDOW 0 43 36 Left 2
WINDOW 3 44 66 Left 2
SYMATTR InstName S1
SYMBOL voltage 2000 -144 R0
WINDOW 0 -12 -2 Left 2
WINDOW 3 47 33 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value PULSE(0 5 20m 1n 1n 40m 80m 3)
SYMBOL ota 496 176 M0
WINDOW 0 -36 -12 Left 2
WINDOW 39 -150 13 Left 2
SYMATTR InstName X1
SYMATTR SpiceLine Ilimit=12u Gm=230u Ro=305k
SYMBOL ota 480 -144 M180
WINDOW 0 -48 153 Left 2
WINDOW 39 -148 129 Left 2
SYMATTR InstName X2
SYMATTR SpiceLine Ilimit=2 Gm=7 Ro=1R
SYMBOL voltage 1136 -112 R0
WINDOW 0 40 27 Left 2
WINDOW 3 40 77 Left 2
WINDOW 123 40 53 Left 2
WINDOW 39 40 55 Left 2
SYMATTR InstName V4
SYMATTR Value 0V
SYMATTR SpiceLine Rser=10m
SYMBOL res 1712 -272 R0
WINDOW 0 36 42 Left 2
WINDOW 3 36 65 Left 2
SYMATTR InstName R2
SYMATTR Value 20R
SYMBOL boost-converter_output-filter 1568 -256 R0
SYMATTR InstName X3
SYMATTR SpiceLine IC=4.9
SYMBOL res 1200 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 0.068
SYMBOL bi 640 -48 R0
WINDOW 0 39 21 Left 2
WINDOW 3 40 55 Left 2
SYMATTR InstName B1
SYMATTR Value I=limit(0,(V(Vout)/V(V3)*I(B2)*1/n),0.499)
SYMBOL cap 320 -48 R0
WINDOW 0 37 11 Left 2
WINDOW 3 37 61 Left 2
WINDOW 39 39 37 Left 2
SYMATTR InstName C6
SYMATTR Value 20µF
SYMATTR SpiceLine Rser=10m Lser=3n
SYMBOL Opamps\\LT1782 2272 400 R0
SYMATTR InstName U1
SYMBOL res 2080 384 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value 220k
SYMBOL cap 2256 240 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C5
SYMATTR Value 1n
SYMBOL Opamps\\LT1782 1696 816 R0
SYMATTR InstName U2
SYMBOL res 1696 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 68k
SYMBOL boost-converter_input-filter 1312 336 R0
SYMATTR InstName X5
SYMBOL voltage 2512 -144 R0
WINDOW 0 37 36 Left 2
WINDOW 3 40 63 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value 5V
SYMBOL res 1664 608 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 100k
SYMBOL res 1376 832 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 1568 992 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R13
SYMATTR Value 100k
SYMBOL res 1360 640 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value 47k
SYMBOL voltage 1376 896 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 39 44 Left 2
WINDOW 3 41 73 Left 2
SYMATTR InstName V7
SYMATTR Value 1V
SYMBOL cap 1488 912 R0
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL cap 1760 496 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value 10n
SYMBOL voltage 2080 480 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 1V
SYMBOL diode 864 624 R0
SYMATTR InstName D1
SYMATTR Value 1SR156-400
SYMBOL diode 864 720 R0
SYMATTR InstName D2
SYMATTR Value 1SR156-400
SYMBOL diode 864 816 R0
SYMATTR InstName D3
SYMATTR Value 1SR156-400
SYMBOL diode 864 912 R0
SYMATTR InstName D4
SYMATTR Value 1SR156-400
SYMBOL diode 864 1008 R0
SYMATTR InstName D5
SYMATTR Value 1SR156-400
SYMBOL diode 864 1104 R0
SYMATTR InstName D6
SYMATTR Value 1SR156-400
SYMBOL current 768 784 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I1
SYMATTR Value 0.5A
SYMBOL res 864 464 R0
SYMATTR InstName R15
SYMATTR Value 0.1R
SYMBOL res 1360 608 R0
SYMATTR InstName R16
SYMATTR Value 13k
SYMBOL voltage 2608 576 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 4V
SYMBOL diode 656 768 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMATTR Value 1SR156-400
SYMBOL cap 608 416 R0
SYMATTR InstName C9
SYMATTR Value 80µ
SYMBOL voltage 1584 992 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V8
SYMATTR Value 1V
SYMBOL res 976 464 R0
SYMATTR InstName R17
SYMATTR Value 0.0001
SYMBOL res 1808 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 13k
SYMBOL voltage 1696 64 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 124 Left 2
SYMATTR InstName V9
SYMATTR Value 1.65
SYMATTR SpiceLine Rser=1
TEXT 1304 176 Left 2 ;.tran 200m
TEXT 1304 144 Left 2 !.param n 0.88
TEXT 1304 -8 Left 2 !.param Cf 47p\n.param Rc 27k\n.param Cc 1n\n.param Cpl 0p\n.param Ra=68.02k
TEXT 2048 -80 Left 2 !.model SW SW(Ron=0.001, Vt=1, Vh=1)
TEXT 1304 216 Left 2 !;ac oct 100 1 1Meg
TEXT 2144 784 Left 2 !.tran 100m
